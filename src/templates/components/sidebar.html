<div class="sidebar">
    <!-- Statistics Section -->
    <div class="sidebar-section" 
         hx-get="{{ url_for('api.sidebar_stats') }}"
         hx-trigger="load, every 10s"
         hx-target="#sidebar-stats">
        <h3 class="sidebar-title">üìà Statistics</h3>
        <div id="sidebar-stats" class="stats-grid">
            <div class="stat-item">
                <div class="stat-value">{{ total_apps|default('---') }}</div>
                <div class="stat-label">Total Apps</div>
            </div>
            <div class="stat-item">
                <div class="stat-value">{{ running_containers|default('---') }}</div>
                <div class="stat-label">Running</div>
            </div>
            <div class="stat-item">
                <div class="stat-value">{{ analyses_today|default('---') }}</div>
                <div class="stat-label">Analyses Today</div>
            </div>
        </div>
    </div>
    
    <!-- Filters Section -->
    <div class="sidebar-section">
        <h3 class="sidebar-title">üîç Filters</h3>
        
        <form hx-get="{{ url_for('api.search_apps') }}" 
              hx-target="#app-list" 
              hx-trigger="change delay:300ms"
              class="filter-form">
            
            <!-- Model Filter -->
            <div class="filter-group">
                <label for="model-filter" class="filter-label">Model</label>
                <select name="model" id="model-filter" class="filter-select">
                    <option value="">All Models</option>
                    {% for model in ai_models|default([]) %}
                    <option value="{{ model.slug }}" 
                            {% if request.args.get('model') == model.slug %}selected{% endif %}>
                        {{ model.display_name }}
                    </option>
                    {% endfor %}
                </select>
            </div>
            
            <!-- Status Filter -->
            <div class="filter-group">
                <label for="status-filter" class="filter-label">Status</label>
                <select name="status" id="status-filter" class="filter-select">
                    <option value="">All Statuses</option>
                    <option value="running" {% if request.args.get('status') == 'running' %}selected{% endif %}>Running</option>
                    <option value="stopped" {% if request.args.get('status') == 'stopped' %}selected{% endif %}>Stopped</option>
                    <option value="error" {% if request.args.get('status') == 'error' %}selected{% endif %}>Error</option>
                </select>
            </div>
            
            <!-- Analysis Status Filter -->
            <div class="filter-group">
                <label for="analysis-filter" class="filter-label">Analysis</label>
                <select name="analysis_status" id="analysis-filter" class="filter-select">
                    <option value="">All</option>
                    <option value="analyzed" {% if request.args.get('analysis_status') == 'analyzed' %}selected{% endif %}>Analyzed</option>
                    <option value="pending" {% if request.args.get('analysis_status') == 'pending' %}selected{% endif %}>Pending</option>
                    <option value="failed" {% if request.args.get('analysis_status') == 'failed' %}selected{% endif %}>Failed</option>
                </select>
            </div>
            
            <!-- Include current search in filter requests -->
            <input type="hidden" name="search" value="{{ request.args.get('search', '') }}">
        </form>
    </div>
    
    <!-- Quick Actions Section -->
    <div class="sidebar-section">
        <h3 class="sidebar-title">‚ö° Quick Actions</h3>
        <div class="quick-actions">
            <button class="action-btn action-btn-primary"
                    hx-get="{{ url_for('batch.create_batch_job') }}"
                    hx-target="#modal-container">
                üöÄ Start Batch Analysis
            </button>
            
            <button class="action-btn action-btn-secondary"
                    hx-post="{{ url_for('api.clear_cache') }}"
                    hx-target="#flash-messages"
                    hx-confirm="Clear all cached data?">
                üßπ Clear Cache
            </button>
            
            <button class="action-btn action-btn-secondary"
                    hx-get="{{ url_for('docker.docker_overview') }}">
                üê≥ Docker Management
            </button>
        </div>
    </div>
    
    <!-- Recent Activity Section -->
    <div class="sidebar-section" 
         hx-get="{{ url_for('api.recent_activity') }}"
         hx-trigger="load, every 30s"
         hx-target="#recent-activity">
        <h3 class="sidebar-title">üìã Recent Activity</h3>
        <div id="recent-activity" class="activity-list">
            <!-- Activity items loaded via HTMX -->
            <div class="activity-placeholder">Loading recent activity...</div>
        </div>
    </div>
    
    <!-- System Info Section -->
    <div class="sidebar-section sidebar-footer">
        <div class="system-info" 
             hx-get="{{ url_for('api.cache_stats') }}"
             hx-trigger="load, every 60s"
             hx-target="#cache-info">
            <div id="cache-info" class="info-text">
                Cache: Loading...
            </div>
        </div>
    </div>
</div>
