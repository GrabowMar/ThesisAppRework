<!-- Infrastructure Status Details Partial -->
<div class="row">
    <!-- Service Health -->
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <h6 class="mb-0">
                    <i class="fas fa-heartbeat mr-2"></i>
                    Service Health Status
                </h6>
            </div>
            <div class="card-body">
                {% if health.testing_infrastructure %}
                    {% set services = health.testing_infrastructure.services %}
                    <div class="list-group list-group-flush">
                        <div class="list-group-item d-flex justify-content-between align-items-center">
                            <div>
                                <strong>Security Scanner</strong>
                                <br><small class="text-muted">Backend & Frontend Security Analysis</small>
                            </div>
                            {% if services.get('security-scanner') %}
                                <span class="badge badge-success">
                                    <i class="fas fa-check-circle"></i> Online
                                </span>
                            {% else %}
                                <span class="badge badge-danger">
                                    <i class="fas fa-times-circle"></i> Offline
                                </span>
                            {% endif %}
                        </div>
                        
                        <div class="list-group-item d-flex justify-content-between align-items-center">
                            <div>
                                <strong>Performance Tester</strong>
                                <br><small class="text-muted">Load Testing & Performance Analysis</small>
                            </div>
                            {% if services.get('performance-tester') %}
                                <span class="badge badge-success">
                                    <i class="fas fa-check-circle"></i> Online
                                </span>
                            {% else %}
                                <span class="badge badge-danger">
                                    <i class="fas fa-times-circle"></i> Offline
                                </span>
                            {% endif %}
                        </div>
                        
                        <div class="list-group-item d-flex justify-content-between align-items-center">
                            <div>
                                <strong>ZAP Scanner</strong>
                                <br><small class="text-muted">OWASP ZAP Security Scanning</small>
                            </div>
                            {% if services.get('zap-scanner') %}
                                <span class="badge badge-success">
                                    <i class="fas fa-check-circle"></i> Online
                                </span>
                            {% else %}
                                <span class="badge badge-danger">
                                    <i class="fas fa-times-circle"></i> Offline
                                </span>
                            {% endif %}
                        </div>
                        
                        <div class="list-group-item d-flex justify-content-between align-items-center">
                            <div>
                                <strong>Test Coordinator</strong>
                                <br><small class="text-muted">Batch Testing & Job Management</small>
                            </div>
                            {% if services.get('test-coordinator') %}
                                <span class="badge badge-success">
                                    <i class="fas fa-check-circle"></i> Online
                                </span>
                            {% else %}
                                <span class="badge badge-danger">
                                    <i class="fas fa-times-circle"></i> Offline
                                </span>
                            {% endif %}
                        </div>
                    </div>
                    
                    <div class="mt-3">
                        <div class="row text-center">
                            <div class="col">
                                <h5 class="mb-0">{{ health.testing_infrastructure.active_tests or 0 }}</h5>
                                <small class="text-muted">Active Tests</small>
                            </div>
                            <div class="col">
                                <h5 class="mb-0">{{ health.testing_infrastructure.base_url or 'localhost' }}</h5>
                                <small class="text-muted">Base URL</small>
                            </div>
                        </div>
                    </div>
                {% else %}
                    <div class="alert alert-warning">
                        <i class="fas fa-exclamation-triangle mr-2"></i>
                        Testing infrastructure is not available or not responding.
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
    
    <!-- Available Tools -->
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <h6 class="mb-0">
                    <i class="fas fa-tools mr-2"></i>
                    Available Security Tools
                </h6>
            </div>
            <div class="card-body">
                {% if tools.security_tools %}
                    <div class="row">
                        <!-- Backend Tools -->
                        <div class="col-12 mb-3">
                            <h6 class="text-primary">Backend Security Tools</h6>
                            <div class="row">
                                {% for tool_id in tools.categories.backend %}
                                    {% set tool = tools.security_tools[tool_id] %}
                                    <div class="col-6 mb-2">
                                        <div class="border rounded p-2">
                                            <strong>{{ tool.name }}</strong>
                                            <br><small class="text-muted">{{ tool.description }}</small>
                                        </div>
                                    </div>
                                {% endfor %}
                            </div>
                        </div>
                        
                        <!-- Frontend Tools -->
                        <div class="col-12">
                            <h6 class="text-info">Frontend Security Tools</h6>
                            <div class="row">
                                {% for tool_id in tools.categories.frontend %}
                                    {% set tool = tools.security_tools[tool_id] %}
                                    <div class="col-6 mb-2">
                                        <div class="border rounded p-2">
                                            <strong>{{ tool.name }}</strong>
                                            <br><small class="text-muted">{{ tool.description }}</small>
                                        </div>
                                    </div>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                {% else %}
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle mr-2"></i>
                        Tool information is not available.
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<!-- ZAP Scan Types -->
{% if tools.zap_scan_types %}
<div class="card mt-3">
    <div class="card-header">
        <h6 class="mb-0">
            <i class="fas fa-spider mr-2"></i>
            ZAP Security Scan Types
        </h6>
    </div>
    <div class="card-body">
        <div class="row">
            {% for scan_id, scan_info in tools.zap_scan_types.items() %}
            <div class="col-md-3 mb-3">
                <div class="border rounded p-3 h-100">
                    <h6 class="text-warning">{{ scan_info.name }}</h6>
                    <p class="text-muted small mb-0">{{ scan_info.description }}</p>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</div>
{% endif %}

<!-- System Information -->
<div class="card mt-3">
    <div class="card-header">
        <h6 class="mb-0">
            <i class="fas fa-info-circle mr-2"></i>
            System Information
        </h6>
    </div>
    <div class="card-body">
        <div class="row">
            <div class="col-md-4">
                <strong>Infrastructure Status:</strong>
                {% if health.testing_infrastructure.status == 'available' %}
                    <span class="text-success">Available</span>
                {% else %}
                    <span class="text-danger">{{ health.testing_infrastructure.status|title }}</span>
                {% endif %}
            </div>
            <div class="col-md-4">
                <strong>Backend Tools:</strong>
                <span class="text-info">{{ tools.categories.backend|length if tools.categories else 0 }}</span>
            </div>
            <div class="col-md-4">
                <strong>Frontend Tools:</strong>
                <span class="text-info">{{ tools.categories.frontend|length if tools.categories else 0 }}</span>
            </div>
        </div>
        
        {% if health.testing_infrastructure.error %}
        <div class="alert alert-danger mt-3 mb-0">
            <strong>Error:</strong> {{ health.testing_infrastructure.error }}
        </div>
        {% endif %}
    </div>
</div>
