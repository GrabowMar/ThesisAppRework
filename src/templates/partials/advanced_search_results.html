<!-- Advanced Search Results Partial -->
<div class="advanced-search-results">
    {% if apps %}
    <div class="search-results-header">
        <div class="results-count">
            <strong>{{ total_results }}</strong> 
            {% if total_results == 1 %}result found{% else %}results found{% endif %}
        </div>
        
        {% if search_params.q %}
        <div class="search-query">
            for "<em>{{ search_params.q }}</em>"
        </div>
        {% endif %}
    </div>
    
    <div class="results-filters-summary">
        {% if search_params.model %}
        <span class="filter-tag">Model: {{ search_params.model }}</span>
        {% endif %}
        {% if search_params.app_type %}
        <span class="filter-tag">App Type: {{ search_params.app_type }}</span>
        {% endif %}
        {% if search_params.status %}
        <span class="filter-tag">Status: {{ search_params.status }}</span>
        {% endif %}
        {% if search_params.analysis_status %}
        <span class="filter-tag">Analysis: {{ search_params.analysis_status }}</span>
        {% endif %}
    </div>
    
    <div class="search-results-list">
        {% for app in apps %}
        <div class="search-result-item">
            <div class="result-icon">
                {% if app.app_number %}
                {{ app.app_number }}
                {% else %}
                üì±
                {% endif %}
            </div>
            
            <div class="result-content">
                <div class="result-title">
                    <strong>{{ app.model.name if app.model else 'Unknown Model' }}</strong> - 
                    App {{ app.app_number if app.app_number else 'Unknown' }}
                </div>
                
                <div class="result-meta">
                    <span class="meta-item status-{{ app.status|lower if app.status else 'unknown' }}">
                        {{ app.status or 'Unknown Status' }}
                    </span>
                    
                    {% if app.has_analysis %}
                    <span class="meta-item analysis-yes">Analyzed</span>
                    {% else %}
                    <span class="meta-item analysis-no">Not Analyzed</span>
                    {% endif %}
                    
                    {% if app.last_updated %}
                    <span class="meta-item">Updated: {{ app.last_updated }}</span>
                    {% endif %}
                </div>
                
                {% if app.description %}
                <div class="result-description">{{ app.description }}</div>
                {% endif %}
            </div>
            
            <div class="result-actions">
                {% if app.model and app.app_number %}
                <a href="{{ url_for('main.app_details', model_slug=app.model.slug, app_number=app.app_number) }}" 
                   class="btn btn-sm btn-outline">View</a>
                
                {% if app.status == 'running' %}
                <a href="http://localhost:{{ app.frontend_port if app.frontend_port else '3000' }}" 
                   target="_blank" 
                   class="btn btn-sm btn-primary">Open</a>
                {% endif %}
                {% endif %}
            </div>
        </div>
        {% endfor %}
    </div>
    
    {% if has_more %}
    <div class="load-more-container">
        <button class="btn btn-outline load-more-btn"
                hx-get="{{ url_for('api.advanced_search') }}"
                hx-include="closest form"
                hx-vals='{"page": {{ (apps|length // 20) + 2 }}}'
                hx-target=".search-results-list"
                hx-swap="beforeend">
            Load More Results
        </button>
    </div>
    {% endif %}
    
    {% else %}
    <div class="no-results">
        <div class="no-results-icon">üîç</div>
        <h4>No results found</h4>
        <p>Try adjusting your search criteria or filters.</p>
    </div>
    {% endif %}
</div>

<style>
.advanced-search-results {
    margin-top: var(--spacing);
}

.search-results-header {
    display: flex;
    align-items: center;
    gap: var(--spacing);
    margin-bottom: var(--spacing);
    padding-bottom: var(--spacing-sm);
    border-bottom: 1px solid var(--border-color);
}

.results-count {
    font-size: 0.875rem;
    color: var(--text-color);
}

.search-query {
    font-size: 0.875rem;
    color: var(--text-muted);
}

.results-filters-summary {
    display: flex;
    flex-wrap: wrap;
    gap: var(--spacing-sm);
    margin-bottom: var(--spacing);
}

.filter-tag {
    background: var(--surface-color);
    color: var(--text-color);
    padding: var(--spacing-xs) var(--spacing-sm);
    border-radius: var(--border-radius);
    font-size: 0.75rem;
    border: 1px solid var(--border-color);
}

.search-results-list {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
}

.search-result-item {
    display: flex;
    align-items: center;
    gap: var(--spacing);
    padding: var(--spacing);
    background: var(--background-color);
    border: 1px solid var(--border-color);
    border-radius: var(--border-radius);
    transition: all var(--transition-fast);
}

.search-result-item:hover {
    background: var(--surface-color);
    border-color: var(--accent-color);
}

.result-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    background: var(--accent-color);
    color: white;
    border-radius: var(--border-radius);
    font-weight: bold;
    font-size: 0.875rem;
    flex-shrink: 0;
}

.result-content {
    flex: 1;
    min-width: 0;
}

.result-title {
    font-size: 0.95rem;
    margin-bottom: var(--spacing-xs);
    color: var(--text-color);
}

.result-meta {
    display: flex;
    flex-wrap: wrap;
    gap: var(--spacing-sm);
    margin-bottom: var(--spacing-xs);
}

.meta-item {
    font-size: 0.75rem;
    padding: var(--spacing-xs) var(--spacing-sm);
    border-radius: var(--border-radius);
    background: var(--surface-color);
    color: var(--text-muted);
}

.meta-item.status-running {
    background: var(--success-color);
    color: white;
}

.meta-item.status-stopped {
    background: var(--warning-color);
    color: white;
}

.meta-item.status-error {
    background: var(--danger-color);
    color: white;
}

.meta-item.analysis-yes {
    background: var(--success-color);
    color: white;
}

.meta-item.analysis-no {
    background: var(--text-muted);
    color: white;
}

.result-description {
    font-size: 0.8rem;
    color: var(--text-muted);
    line-height: 1.4;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

.result-actions {
    display: flex;
    gap: var(--spacing-sm);
    flex-shrink: 0;
}

.load-more-container {
    text-align: center;
    margin-top: var(--spacing);
    padding-top: var(--spacing);
    border-top: 1px solid var(--border-color);
}

.no-results {
    text-align: center;
    padding: var(--spacing-xl);
    color: var(--text-muted);
}

.no-results-icon {
    font-size: 3rem;
    margin-bottom: var(--spacing);
    opacity: 0.5;
}

.no-results h4 {
    margin: 0 0 var(--spacing-sm) 0;
    color: var(--text-color);
    font-size: 1.1rem;
}

.no-results p {
    margin: 0;
    font-size: 0.875rem;
}

/* Mobile responsive */
@media (max-width: 768px) {
    .search-result-item {
        flex-direction: column;
        align-items: flex-start;
        gap: var(--spacing-sm);
    }
    
    .result-content {
        width: 100%;
    }
    
    .result-actions {
        width: 100%;
        justify-content: flex-end;
    }
    
    .search-results-header {
        flex-direction: column;
        align-items: flex-start;
        gap: var(--spacing-sm);
    }
    
    .results-filters-summary {
        flex-direction: column;
    }
}

@media (max-width: 480px) {
    .result-meta {
        flex-direction: column;
        gap: var(--spacing-xs);
    }
    
    .result-actions {
        justify-content: center;
    }
    
    .result-actions .btn {
        flex: 1;
    }
}
</style>
