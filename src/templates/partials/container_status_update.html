<!-- Container Status Update for HTMX -->
{% if message %}
<div class="alert success" id="action-message">
    {{ message }}
</div>
<script>
    // Auto-hide success message after 3 seconds
    setTimeout(() => {
        const msg = document.getElementById('action-message');
        if (msg) msg.style.opacity = '0';
        setTimeout(() => {
            if (msg) msg.remove();
        }, 300);
    }, 3000);
</script>
{% endif %}

<!-- Updated Status Information -->
<div class="status-containers" id="status-{{ model }}-{{ app_num }}">
    <div class="container-status-item">
        <span class="container-type">Backend</span>
        <span class="status-badge {{ 'running' if statuses.backend == 'running' else 'stopped' if statuses.backend == 'stopped' else 'error' }}">
            {% if statuses.backend == 'running' %}
                ●
            {% elif statuses.backend == 'stopped' %}
                ◯
            {% else %}
                ⚠
            {% endif %}
            {{ statuses.backend|title }}
        </span>
        {% if statuses.backend_port %}
        <span class="port-info">:{{ statuses.backend_port }}</span>
        {% endif %}
    </div>
    
    <div class="container-status-item">
        <span class="container-type">Frontend</span>
        <span class="status-badge {{ 'running' if statuses.frontend == 'running' else 'stopped' if statuses.frontend == 'stopped' else 'error' }}">
            {% if statuses.frontend == 'running' %}
                ●
            {% elif statuses.frontend == 'stopped' %}
                ◯
            {% else %}
                ⚠
            {% endif %}
            {{ statuses.frontend|title }}
        </span>
        {% if statuses.frontend_port %}
        <span class="port-info">:{{ statuses.frontend_port }}</span>
        {% endif %}
    </div>
</div>

<!-- Update the action buttons state if needed -->
<script>
    // Update button states based on container status
    const containerCard = document.querySelector('[data-model="{{ model }}"][data-app="{{ app_num }}"]');
    if (containerCard) {
        const isRunning = {{ 'true' if statuses.backend == 'running' and statuses.frontend == 'running' else 'false' }};
        const startBtn = containerCard.querySelector('.start-btn');
        const stopBtn = containerCard.querySelector('.stop-btn');
        const restartBtn = containerCard.querySelector('.restart-btn');
        
        if (startBtn) startBtn.disabled = isRunning;
        if (stopBtn) stopBtn.disabled = !isRunning;
        if (restartBtn) restartBtn.disabled = !isRunning;
        
        // Update overall status indicator
        const statusIndicator = containerCard.querySelector('.status-indicator');
        if (statusIndicator) {
            statusIndicator.className = 'status-indicator ' + (isRunning ? 'running' : 'stopped');
        }
    }
</script>
