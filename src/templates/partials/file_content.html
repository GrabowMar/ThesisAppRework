<div class="file-content-viewer">
    <div class="file-header bg-light px-3 py-2 border-bottom">
        <div class="d-flex justify-content-between align-items-center">
            <div>
                <i class="fas fa-file-code text-info mr-2"></i>
                <strong>{{ file_name }}</strong>
                <small class="text-muted ml-2">{{ file_path }}</small>
            </div>
            <div class="btn-group btn-group-sm" role="group">
                <button class="btn btn-outline-secondary" onclick="copyContent()">
                    <i class="fas fa-copy mr-1"></i>
                    Copy
                </button>
                <button class="btn btn-outline-primary" onclick="downloadFile()">
                    <i class="fas fa-download mr-1"></i>
                    Download
                </button>
            </div>
        </div>
    </div>
    
    <div class="file-content-body">
        <pre><code class="language-{{ language }}">{{ content }}</code></pre>
    </div>
</div>

<style>
.file-content-viewer {
    border: 1px solid #dee2e6;
    border-radius: 0.25rem;
    overflow: hidden;
}

.file-content-body {
    max-height: 500px;
    overflow-y: auto;
    background: #f8f9fa;
}

.file-content-body pre {
    margin: 0;
    padding: 1rem;
    background: transparent;
    border: none;
    font-size: 0.875rem;
    line-height: 1.4;
    white-space: pre-wrap;
    word-wrap: break-word;
}

.file-content-body code {
    background: transparent;
    color: inherit;
    padding: 0;
}

/* Simple syntax highlighting */
.language-python .keyword { color: #d73a49; font-weight: bold; }
.language-python .string { color: #032f62; }
.language-python .comment { color: #6a737d; font-style: italic; }
.language-python .number { color: #005cc5; }

.language-javascript .keyword { color: #d73a49; font-weight: bold; }
.language-javascript .string { color: #032f62; }
.language-javascript .comment { color: #6a737d; font-style: italic; }
.language-javascript .number { color: #005cc5; }

.language-html .tag { color: #22863a; }
.language-html .attribute { color: #6f42c1; }
.language-html .string { color: #032f62; }

.language-css .property { color: #005cc5; }
.language-css .value { color: #032f62; }
.language-css .selector { color: #6f42c1; }

.language-json .key { color: #005cc5; font-weight: bold; }
.language-json .string { color: #032f62; }
.language-json .number { color: #005cc5; }
.language-json .boolean { color: #d73a49; }
</style>

<script>
function copyContent() {
    const content = document.querySelector('.file-content-body pre code').textContent;
    navigator.clipboard.writeText(content).then(() => {
        showFileNotification('Content copied to clipboard!', 'success');
    }).catch(() => {
        showFileNotification('Failed to copy content', 'error');
    });
}

function downloadFile() {
    const content = document.querySelector('.file-content-body pre code').textContent;
    const fileName = '{{ file_name }}';
    const blob = new Blob([content], { type: 'text/plain' });
    const url = window.URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = fileName;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    window.URL.revokeObjectURL(url);
    showFileNotification('File downloaded!', 'success');
}

function showFileNotification(message, type) {
    const notification = document.createElement('div');
    notification.className = `alert alert-${type === 'success' ? 'success' : 'danger'} alert-dismissible fade show position-fixed`;
    notification.style.cssText = 'top: 80px; right: 20px; z-index: 9999; max-width: 300px;';
    notification.innerHTML = `
        <i class="fas fa-${type === 'success' ? 'check-circle' : 'exclamation-circle'} mr-2"></i>
        ${message}
        <button type="button" class="close" data-dismiss="alert">
            <span aria-hidden="true">&times;</span>
        </button>
    `;
    document.body.appendChild(notification);
    
    setTimeout(() => {
        if (notification.parentNode) {
            notification.remove();
        }
    }, 3000);
}
</script>
