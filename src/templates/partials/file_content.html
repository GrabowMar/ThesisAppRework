<div class="file-content-viewer">
    <div class="file-header bg-light px-3 py-2 border-bottom">
        <div class="d-flex justify-content-between align-items-center">
            <div>
                <i class="fas fa-file-code text-info mr-2"></i>
                <strong>{{ file_name }}</strong>
                <small class="text-muted ml-2">{{ file_path }}</small>
            </div>
            <div class="btn-group btn-group-sm" role="group">
                <button class="btn btn-outline-secondary" onclick="copyContent()">
                    <i class="fas fa-copy mr-1"></i>
                    Copy
                </button>
                <button class="btn btn-outline-primary" onclick="downloadFile()">
                    <i class="fas fa-download mr-1"></i>
                    Download
                </button>
            </div>
        </div>
    </div>
    
    <div class="file-content-body">
        <pre><code class="language-{{ language }}">{{ content }}</code></pre>
    </div>
</div>

<script>
function copyContent() {
    const content = document.querySelector('.file-content-body pre code').textContent;
    navigator.clipboard.writeText(content).then(() => {
        showFileNotification('Content copied to clipboard!', 'success');
    }).catch(() => {
        showFileNotification('Failed to copy content', 'error');
    });
}

function downloadFile() {
    const content = document.querySelector('.file-content-body pre code').textContent;
    const fileName = '{{ file_name }}';
    const blob = new Blob([content], { type: 'text/plain' });
    const url = window.URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = fileName;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    window.URL.revokeObjectURL(url);
    showFileNotification('File downloaded!', 'success');
}

function showFileNotification(message, type) {
    const notification = document.createElement('div');
    notification.className = `alert alert-${type === 'success' ? 'success' : 'danger'} alert-dismissible fade show position-fixed notification-fixed`;
    notification.innerHTML = `
        <i class="fas fa-${type === 'success' ? 'check-circle' : 'exclamation-circle'} mr-2"></i>
        ${message}
        <button type="button" class="close" data-dismiss="alert">
            <span aria-hidden="true">&times;</span>
        </button>
    `;
    document.body.appendChild(notification);
    
    setTimeout(() => {
        if (notification.parentNode) {
            notification.remove();
        }
    }, 3000);
}
</script>
