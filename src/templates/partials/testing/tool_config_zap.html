<!-- ZAP Configuration Panel -->
<div class="tool-config-panel" data-tool-config="zap">
    <div class="d-flex justify-content-between align-items-center mb-3">
        <h6 class="mb-0"><i class="fas fa-globe me-2"></i>OWASP ZAP Configuration</h6>
        <span class="badge bg-danger">Web Security</span>
    </div>
    
    <div class="row">
        <!-- Scan Type -->
        <div class="col-md-6">
            <div class="mb-3">
                <label for="zap_scan_type" class="form-label">Scan Type</label>
                <select name="zap_scan_type" id="zap_scan_type" class="form-select" required>
                    <option value="baseline" selected>Baseline Scan</option>
                    <option value="active">Active Scan</option>
                    <option value="api">API Scan</option>
                    <option value="full">Full Scan</option>
                </select>
                <div class="form-text">Baseline is passive, Active scans can modify the target</div>
            </div>
        </div>
        
        <!-- Target URL -->
        <div class="col-md-6">
            <div class="mb-3">
                <label for="zap_target_url" class="form-label">Target URL *</label>
                <input type="url" name="zap_target_url" id="zap_target_url" class="form-control" 
                       placeholder="http://localhost:3000" required>
                <div class="form-text">The web application URL to scan</div>
            </div>
        </div>
    </div>
    
    <div class="row">
        <!-- API Definition -->
        <div class="col-md-6">
            <div class="mb-3">
                <label for="zap_api_definition" class="form-label">API Definition URL</label>
                <input type="url" name="zap_api_definition" id="zap_api_definition" class="form-control" 
                       placeholder="http://localhost:3000/swagger.json">
                <div class="form-text">OpenAPI/Swagger definition for API scanning</div>
            </div>
        </div>
        
        <!-- API Format -->
        <div class="col-md-6">
            <div class="mb-3">
                <label for="zap_api_format" class="form-label">API Format</label>
                <select name="zap_api_format" id="zap_api_format" class="form-select">
                    <option value="openapi" selected>OpenAPI/Swagger</option>
                    <option value="soap">SOAP</option>
                    <option value="graphql">GraphQL</option>
                </select>
            </div>
        </div>
    </div>
    
    <div class="row">
        <!-- Advanced Options -->
        <div class="col-md-4">
            <div class="form-check">
                <input class="form-check-input" type="checkbox" name="zap_alpha_passive" id="zap_alpha_passive">
                <label class="form-check-label" for="zap_alpha_passive">
                    Alpha Passive Rules
                </label>
                <div class="form-text">Include experimental rules</div>
            </div>
        </div>
        
        <div class="col-md-4">
            <div class="form-check">
                <input class="form-check-input" type="checkbox" name="zap_safe_mode" id="zap_safe_mode" checked>
                <label class="form-check-label" for="zap_safe_mode">
                    Safe Mode
                </label>
                <div class="form-text">Prevent potentially harmful requests</div>
            </div>
        </div>
        
        <div class="col-md-4">
            <div class="form-check">
                <input class="form-check-input" type="checkbox" name="zap_debug" id="zap_debug">
                <label class="form-check-label" for="zap_debug">
                    Debug Output
                </label>
                <div class="form-text">Include debug information</div>
            </div>
        </div>
    </div>
    
    <div class="row">
        <!-- Report Format -->
        <div class="col-md-6">
            <div class="mb-3">
                <label for="zap_format" class="form-label">Report Format</label>
                <select name="zap_format" id="zap_format" class="form-select">
                    <option value="json" selected>JSON</option>
                    <option value="html">HTML</option>
                    <option value="xml">XML</option>
                    <option value="md">Markdown</option>
                </select>
            </div>
        </div>
        
        <!-- Minimum Alert Level -->
        <div class="col-md-6">
            <div class="mb-3">
                <label for="zap_min_level" class="form-label">Minimum Alert Level</label>
                <select name="zap_min_level" id="zap_min_level" class="form-select">
                    <option value="PASS">PASS</option>
                    <option value="IGNORE">IGNORE</option>
                    <option value="INFO">INFO</option>
                    <option value="WARN" selected>WARN</option>
                    <option value="FAIL">FAIL</option>
                </select>
                <div class="form-text">Fail the scan if alerts at or above this level are found</div>
            </div>
        </div>
    </div>
    
    <div class="row">
        <!-- Scan Limits -->
        <div class="col-md-6">
            <div class="mb-3">
                <label for="zap_max_time" class="form-label">Maximum Scan Time (minutes)</label>
                <input type="number" name="zap_max_time" id="zap_max_time" class="form-control" 
                       min="0" placeholder="0 = unlimited">
                <div class="form-text">0 for unlimited scan time</div>
            </div>
        </div>
        
        <!-- Passive Scan Delay -->
        <div class="col-md-6">
            <div class="mb-3">
                <label for="zap_passive_scan_delay" class="form-label">Passive Scan Delay (seconds)</label>
                <input type="number" name="zap_passive_scan_delay" id="zap_passive_scan_delay" 
                       class="form-control" min="0" value="0">
                <div class="form-text">Wait time for passive scan to complete</div>
            </div>
        </div>
    </div>
    
    <!-- Authentication Context -->
    <div class="mb-3">
        <label for="zap_auth_context" class="form-label">Authentication Context</label>
        <textarea name="zap_auth_context" id="zap_auth_context" class="form-control" rows="3" 
                  placeholder='{"type": "form", "loginUrl": "/login", "username": "admin", "password": "admin"}'></textarea>
        <div class="form-text">JSON configuration for authenticated scanning</div>
    </div>
    
    <!-- Custom Headers -->
    <div class="mb-3">
        <label for="zap_custom_headers" class="form-label">Custom Headers</label>
        <textarea name="zap_custom_headers" id="zap_custom_headers" class="form-control" rows="2" 
                  placeholder='{"Authorization": "Bearer token", "X-API-Key": "your-key"}'></textarea>
        <div class="form-text">JSON object with custom HTTP headers</div>
    </div>
    
    <!-- Real-time validation feedback -->
    <div class="validation-feedback" id="zap-validation"></div>
    
    <!-- URL validation script -->
    <script>
        document.getElementById('zap_target_url').addEventListener('blur', function() {
            const url = this.value;
            const feedback = document.getElementById('zap-validation');
            
            if (url && !url.match(/^https?:\/\/.+/)) {
                feedback.textContent = 'Please enter a valid URL (http:// or https://)';
                feedback.classList.add('show');
                this.classList.add('is-invalid');
            } else {
                feedback.classList.remove('show');
                this.classList.remove('is-invalid');
            }
        });
    </script>
</div>
