{# Application overview - Compact Layout #}
<div class="row g-2">
  {# Combined Identity & Lifecycle #}
  <div class="col-lg-6">
    <div class="card card-sm h-100">
      <div class="card-body py-2">
        <div class="row g-3">
          {# Identity Column #}
          <div class="col-md-6">
            <div class="d-flex align-items-center mb-2">
              <i class="fas fa-id-badge text-primary me-2" aria-hidden="true"></i>
              <span class="text-muted small text-uppercase fw-bold">Identity</span>
            </div>
            <div class="row row-cols-2 g-2">
              <div class="col">
                <div class="text-muted small">Model</div>
                <a href="/models/{{ app_data.model_slug }}" class="fw-medium text-truncate d-block text-reset" title="View {{ app_data.model_slug }} model details">{{ app_data.model_slug }}</a>
              </div>
              <div class="col">
                <div class="text-muted small">Provider</div>
                <span class="badge bg-primary-lt text-primary">{{ app_data.provider or model.provider }}</span>
              </div>
              <div class="col">
                <div class="text-muted small">Application</div>
                <div class="fw-medium">#{{ app_data.app_number }}</div>
              </div>
              <div class="col">
                <div class="text-muted small">Type</div>
                <div class="fw-medium">{{ app_data.app_type|default('unknown')|replace('_', ' ')|title }}</div>
              </div>
            </div>
          </div>
          {# Lifecycle Column #}
          <div class="col-md-6">
            <div class="d-flex align-items-center mb-2">
              <i class="fas fa-life-ring text-success me-2" aria-hidden="true"></i>
              <span class="text-muted small text-uppercase fw-bold">Lifecycle</span>
            </div>
            <div class="row row-cols-2 g-2">
              <div class="col">
                <div class="text-muted small">Container</div>
                <span class="badge {{ 'bg-success-lt text-success' if app_data.container_status == 'running' else ('bg-warning-lt text-warning' if app_data.container_status == 'building' else 'bg-secondary-lt') }}">
                  {{ app_data.container_status|default('unknown')|replace('_', ' ')|title }}
                </span>
              </div>
              <div class="col">
                <div class="text-muted small">Generation</div>
                <span class="badge {{ 'bg-success-lt text-success' if app_data.generation_status == 'completed' else ('bg-warning-lt text-warning' if app_data.generation_status == 'pending' else 'bg-secondary-lt') }}">
                  {{ app_data.generation_status|default('unknown')|replace('_', ' ')|title }}
                </span>
              </div>
              <div class="col">
                <div class="text-muted small">Created</div>
                <div class="fw-medium">{% if app_data.created_at %}{{ app_data.created_at.strftime('%m/%d %H:%M') }}{% else %}—{% endif %}</div>
              </div>
              <div class="col">
                <div class="text-muted small">Ports</div>
                <div class="fw-medium">{{ app_data.ports|length }}</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  {# Code Footprint - Compact #}
  <div class="col-lg-3 col-md-6">
    <div class="card card-sm h-100">
      <div class="card-body py-2">
        <div class="d-flex align-items-center mb-2">
          <i class="fas fa-chart-bar text-info me-2" aria-hidden="true"></i>
          <span class="text-muted small text-uppercase fw-bold">Code Footprint</span>
        </div>
        <div class="row g-2 text-center">
          <div class="col-6">
            <div class="h3 mb-0 text-primary">{{ code_stats.total_loc }}</div>
            <div class="text-muted small">Lines</div>
          </div>
          <div class="col-6">
            <div class="h3 mb-0 text-success">{{ code_stats.total_files }}</div>
            <div class="text-muted small">Files</div>
          </div>
        </div>
        {% if code_stats.by_language %}
        <div class="d-flex flex-wrap gap-1 mt-2 justify-content-center">
          {% for lang, data in code_stats.by_language.items() %}
            <span class="badge bg-secondary-lt small">{{ lang }}: {{ data.loc }}</span>
          {% endfor %}
        </div>
        {% endif %}
      </div>
    </div>
  </div>

  {# Fixes Applied - Compact #}
  {% set total_fixes = (app_data.retry_fixes|default(0)) + (app_data.automatic_fixes|default(0)) + (app_data.llm_fixes|default(0)) + (app_data.manual_fixes|default(0)) %}
  <div class="col-lg-3 col-md-6">
    <div class="card card-sm h-100">
      <div class="card-body py-2">
        <div class="d-flex align-items-center mb-2">
          <i class="fas fa-wrench text-orange me-2" aria-hidden="true"></i>
          <span class="text-muted small text-uppercase fw-bold">Fixes Applied</span>
          {% if total_fixes > 0 %}
          <span class="badge bg-orange-lt text-orange ms-2">{{ total_fixes }}</span>
          {% endif %}
        </div>
        <div class="row row-cols-2 g-2">
          <div class="col">
            <div class="d-flex align-items-center justify-content-between">
              <span class="text-muted small" title="Retry attempts during generation">
                <i class="fas fa-redo me-1"></i>Retry
              </span>
              <span class="fw-medium {{ 'text-orange' if app_data.retry_fixes|default(0) > 0 else 'text-muted' }}">
                {{ app_data.retry_fixes|default(0) }}
              </span>
            </div>
          </div>
          <div class="col">
            <div class="d-flex align-items-center justify-content-between">
              <span class="text-muted small" title="Script-based automatic fixes during generation">
                <i class="fas fa-magic me-1"></i>Auto
              </span>
              <span class="fw-medium {{ 'text-info' if app_data.automatic_fixes|default(0) > 0 else 'text-muted' }}">
                {{ app_data.automatic_fixes|default(0) }}
              </span>
            </div>
          </div>
          <div class="col">
            <div class="d-flex align-items-center justify-content-between">
              <span class="text-muted small" title="LLM-based fixes applied during generation">
                <i class="fas fa-robot me-1"></i>LLM
              </span>
              <span class="fw-medium {{ 'text-purple' if app_data.llm_fixes|default(0) > 0 else 'text-muted' }}">
                {{ app_data.llm_fixes|default(0) }}
              </span>
            </div>
          </div>
          <div class="col">
            <div class="d-flex align-items-center justify-content-between">
              <span class="text-muted small" title="Manual fixes applied post-generation">
                <i class="fas fa-user-edit me-1"></i>Manual
              </span>
              <span class="fw-medium {{ 'text-success' if app_data.manual_fixes|default(0) > 0 else 'text-muted' }}">
                {{ app_data.manual_fixes|default(0) }}
              </span>
            </div>
          </div>
        </div>
        {% if total_fixes == 0 %}
        <div class="text-center text-muted small mt-1">
          <i class="fas fa-check-circle text-success me-1"></i>No fixes
        </div>
        {% endif %}
      </div>
    </div>
  </div>

  {# Frameworks & Highlights - Inline #}
  <div class="col-12">
    <div class="card card-sm">
      <div class="card-body py-2">
        <div class="d-flex align-items-center flex-wrap gap-3">
          {# Frameworks #}
          {% if app_data.backend_framework or app_data.frontend_framework %}
          <div class="d-flex align-items-center gap-2">
            <i class="fas fa-layer-group text-purple" aria-hidden="true"></i>
            <span class="text-muted small">Frameworks:</span>
            {% if app_data.backend_framework %}
              <span class="badge bg-success-lt text-success"><i class="fas fa-server me-1"></i>{{ app_data.backend_framework }}</span>
            {% endif %}
            {% if app_data.frontend_framework %}
              <span class="badge bg-info-lt text-info"><i class="fas fa-desktop me-1"></i>{{ app_data.frontend_framework }}</span>
            {% endif %}
          </div>
          {% endif %}
          {# Highlights #}
          <div class="d-flex align-items-center gap-2">
            <i class="fas fa-bolt text-warning" aria-hidden="true"></i>
            <span class="badge bg-secondary-lt"><i class="fas fa-layer-group me-1"></i>{{ model.apps_count }} sibling apps</span>
            {% if app_data.has_docker_compose %}
            <span class="badge bg-success-lt"><i class="fas fa-cubes me-1"></i>Compose Ready</span>
            {% endif %}
            <span class="badge bg-secondary-lt"><i class="fas fa-clock me-1"></i>{{ app_data.updated_at.strftime('%m/%d %H:%M') if app_data.updated_at else '—' }}</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
