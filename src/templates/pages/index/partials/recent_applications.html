{% if applications %}
<table class="table table-striped table-vcenter table-hover table-sm card-table mb-0">
  <thead>
    <tr>
      <th class="text-nowrap">Application</th>
      <th class="text-nowrap">Model</th>
      <th class="text-nowrap">Type</th>
      <th class="text-nowrap">Status</th>
      <th class="text-nowrap">Created</th>
      <th class="w-1 text-nowrap">Actions</th>
    </tr>
  </thead>
  <tbody>
    {% for app in applications %}
    <tr>
      <td class="text-nowrap">
        <div class="d-flex align-items-center gap-2">
          <span class="avatar avatar-sm bg-primary-lt">{{ app.app_number }}</span>
          <div class="flex-fill">
            <strong>App #{{ app.app_number }}</strong>
          </div>
        </div>
      </td>
      <td class="text-nowrap">
        <div class="d-flex align-items-center gap-2">
          <span class="badge bg-azure-lt text-uppercase">{{ app.model_provider|upper if app.model_provider else '?' }}</span>
          <span class="text-truncate">{{ app.model_display_name|truncate(20) if app.model_display_name else app.model_slug or '—' }}</span>
        </div>
      </td>
      <td>
        {% if app.app_type %}
          <span class="badge bg-info-lt">{{ app.app_type|replace('_', ' ')|title }}</span>
        {% else %}
          <span class="text-muted">—</span>
        {% endif %}
      </td>
      <td>
        {% if app.status == 'running' %}
          <span class="badge bg-success-lt">
            <i class="fas fa-play me-1"></i>Running
          </span>
        {% elif app.status == 'stopped' %}
          <span class="badge bg-secondary-lt">
            <i class="fas fa-stop me-1"></i>Stopped
          </span>
        {% elif app.status == 'error' %}
          <span class="badge bg-danger-lt">
            <i class="fas fa-exclamation-triangle me-1"></i>Error
          </span>
        {% elif app.status == 'building' %}
          <span class="badge bg-warning-lt">
            <i class="fas fa-hammer me-1"></i>Building
          </span>
        {% else %}
          <span class="badge bg-muted-lt">
            <i class="fas fa-question me-1"></i>{{ app.status|title if app.status else 'Unknown' }}
          </span>
        {% endif %}
      </td>
      <td class="text-nowrap text-muted">
        {% if app.created_at %}{{ app.created_at.strftime('%m/%d %H:%M') }}{% else %}—{% endif %}
      </td>
      <td>
        <div class="btn-group" role="group">
          <a href="/applications/{{ app.model_slug }}/{{ app.app_number }}" class="btn btn-outline-primary btn-sm" title="View details">
            <i class="fas fa-eye"></i>
          </a>
          {% if app.status == 'running' and app.ports %}
            <a href="http://localhost:{{ app.ports[0].host_port }}" target="_blank" rel="noopener" class="btn btn-success btn-sm" title="Visit application">
              <i class="fas fa-external-link-alt"></i>
            </a>
          {% else %}
            <button class="btn btn-outline-success btn-sm" onclick="startApplication('{{ app.model_slug }}', '{{ app.app_number }}')" title="Start application" {% if app.status == 'running' %}disabled{% endif %}>
              <i class="fas fa-play"></i>
            </button>
          {% endif %}
        </div>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% else %}
<div class="empty">
  <div class="empty-icon">
    <i class="fas fa-cubes text-muted"></i>
  </div>
  <p class="empty-title">No applications yet</p>
  <p class="empty-subtitle text-muted">
    Generate your first application to see it here.
  </p>
  <div class="empty-action">
    <a href="{{ url_for('applications.applications_index') if 'applications.applications_index' in current_app.view_functions else '/applications' }}" class="btn btn-primary">
      <i class="fas fa-plus me-2"></i>
      Generate Application
    </a>
  </div>
</div>
{% endif %}