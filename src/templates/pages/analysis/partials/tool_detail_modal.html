{# Tool Detail Modal - Generic modal for displaying detailed tool information #}
<div class="modal fade" id="toolDetailModal" tabindex="-1" aria-labelledby="toolDetailModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-xl modal-dialog-scrollable">
    <div class="modal-content">
      <div class="modal-header">
        <div class="d-flex align-items-center gap-3">
          <i class="fa-solid fa-wrench fa-lg text-primary"></i>
          <div>
            <h5 class="modal-title mb-0" id="toolDetailModalLabel">
              <span id="modal-tool-name">Tool Details</span>
            </h5>
            <small class="text-muted" id="modal-tool-subtitle"></small>
          </div>
        </div>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      
      <div class="modal-body">
        {# Loading State #}
        <div id="modal-loading" class="text-center py-5">
          <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Loading...</span>
          </div>
          <p class="text-muted mt-3">Loading tool details...</p>
        </div>

        {# Error State #}
        <div id="modal-error" class="alert alert-danger d-none" role="alert">
          <i class="fa-solid fa-exclamation-triangle me-2"></i>
          <span id="modal-error-message">Failed to load tool details</span>
        </div>

        {# Content Container #}
        <div id="modal-content" class="d-none">
          {# Compact Metadata Bar #}
          <div class="bg-light border-bottom px-3 py-2 mb-2">
            <div class="row g-2 align-items-center small">
              <div class="col-auto">
                <strong class="text-muted">Status:</strong> <span id="meta-status">—</span>
              </div>
              <div class="col-auto border-start ps-2">
                <strong class="text-muted">Time:</strong> <span id="meta-exec-time">—</span>
              </div>
              <div class="col-auto border-start ps-2">
                <strong class="text-muted">Issues:</strong> <span id="meta-total-issues" class="fw-bold">—</span>
              </div>
              <div class="col-auto border-start ps-2" id="meta-exit-container">
                <strong class="text-muted">Exit Code:</strong> <span id="meta-exit-code">—</span>
              </div>
              <div class="col-auto" id="meta-additional">
                {# Additional metadata populated dynamically #}
              </div>
            </div>
          </div>

          {# Severity Summary (for static/security tools) #}
          <div class="border-bottom pb-2 mb-2 d-none" id="severity-summary-card">
            <div class="px-3">
              <small class="text-muted text-uppercase fw-bold"><i class="fa-solid fa-chart-bar me-1"></i>Severity:</small>
              <span id="severity-breakdown" class="ms-2">
                {# Populated dynamically #}
              </span>
            </div>
          </div>

          {# Performance Metrics (for performance tools) #}
          <div class="bg-light border-bottom px-3 py-2 mb-2 d-none" id="performance-metrics-card">
            <div class="row g-2 align-items-center small">
              <div class="col-auto">
                <strong class="text-muted"><i class="fa-solid fa-gauge-high me-1"></i>Metrics:</strong>
              </div>
              <div id="performance-metrics" class="col-auto">
                {# Populated dynamically #}
              </div>
            </div>
          </div>

          {# Issues Table Section #}
          <div class="border rounded mb-2" id="issues-card">
            <div class="bg-light border-bottom px-3 py-2 d-flex justify-content-between align-items-center">
              <div class="small fw-bold">
                <i class="fa-solid fa-list me-1"></i><span id="issues-title">Issues</span>
                <span class="badge bg-secondary-lt ms-1" id="issues-count-badge">0</span>
              </div>
              <div class="d-flex gap-1">
                <select class="form-select form-select-sm" id="severity-filter" style="width: 120px; font-size: 0.75rem;">
                  <option value="">All</option>
                  <option value="CRITICAL">Critical</option>
                  <option value="HIGH">High</option>
                  <option value="MEDIUM">Medium</option>
                  <option value="LOW">Low</option>
                  <option value="INFO">Info</option>
                </select>
                <button class="btn btn-sm btn-ghost-primary" id="export-issues-btn" title="Export to CSV">
                  <i class="fa-solid fa-download"></i>
                </button>
              </div>
            </div>
            <div class="p-0">
              <div class="table-responsive" style="max-height: 400px; overflow-y: auto;">
                <table class="table table-sm table-hover mb-0" id="issues-table" style="font-size: 0.813rem;">
                  <thead class="sticky-top bg-white" style="top: 0; z-index: 10;">
                    <tr>
                      <th width="7%" class="py-1">Severity</th>
                      <th width="10%" class="py-1">Rule</th>
                      <th width="18%" class="py-1">File</th>
                      <th width="4%" class="py-1 text-center">Line</th>
                      <th width="55%" class="py-1">Description</th>
                      <th width="6%" class="py-1 text-center">CWE</th>
                    </tr>
                  </thead>
                  <tbody id="issues-table-body">
                    {# Populated dynamically via JavaScript #}
                  </tbody>
                </table>
              </div>
              
              {# Pagination #}
              <div class="bg-light border-top px-3 py-2 d-flex justify-content-between align-items-center">
                <small class="text-muted" id="pagination-info">
                  <span id="items-start">0</span>-<span id="items-end">0</span> of <span id="items-total">0</span>
                </small>
                <nav>
                  <ul class="pagination pagination-sm mb-0" id="pagination-controls" style="font-size: 0.75rem;">
                    {# Populated dynamically #}
                  </ul>
                </nav>
              </div>
            </div>
          </div>

          {# SARIF Section #}
          <div class="border-top pt-2 mt-2 d-none" id="sarif-card">
            <div class="px-3 pb-2">
              <div class="d-flex justify-content-between align-items-center mb-2">
                <small class="text-muted fw-bold"><i class="fa-solid fa-file-shield me-1"></i>SARIF</small>
                <div class="d-flex gap-1">
                  <button class="btn btn-sm btn-ghost-info" id="sarif-preview-toggle" style="font-size: 0.75rem;">
                    <i class="fa-solid fa-eye"></i> Preview
                  </button>
                  <a href="#" class="btn btn-sm btn-ghost-success" id="sarif-download-btn" target="_blank" style="font-size: 0.75rem;">
                    <i class="fa-solid fa-download"></i>
                  </a>
                </div>
              </div>
              <div class="small">
                <code class="text-primary" id="sarif-file-path" style="font-size: 0.75rem;">—</code>
              </div>
              <div id="sarif-preview" class="d-none mt-2">
                <pre class="bg-light p-2 rounded" style="max-height: 200px; overflow-y: auto; font-size: 0.7rem;"><code id="sarif-preview-content"></code></pre>
              </div>
            </div>
          </div>

          {# Configuration Section #}
          <div class="border-top pt-2 mt-2 d-none" id="config-card">
            <div class="px-3 pb-2">
              <small class="text-muted fw-bold"><i class="fa-solid fa-cog me-1"></i>Configuration</small>
              <pre class="bg-light p-2 rounded mb-0 mt-2" style="max-height: 150px; overflow-y: auto; font-size: 0.7rem;"><code id="config-content"></code></pre>
            </div>
          </div>
        </div>
      </div>
      
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
