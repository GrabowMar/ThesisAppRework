{# Core metadata detail fragment (migrated) #}
<div class="card mb-4">
  <div class="card-body p-3">
    <div class="row g-3 small">
      <div class="col-sm-6 col-lg-4">
        <div class="text-muted text-uppercase tiny">Status</div>
        {% set st = (task.derived_status or task.status)|lower %}
        {% if st == 'running' %}
          <span class="badge bg-warning-lt text-uppercase"><i class="fas fa-spinner fa-spin me-1"></i>{{ st }}</span>
        {% elif st in ['completed','success'] %}
          <span class="badge bg-success-lt text-uppercase"><i class="fas fa-check me-1"></i>{{ st }}</span>
        {% elif st == 'failed' %}
          <span class="badge bg-danger-lt text-uppercase"><i class="fas fa-times me-1"></i>{{ st }}</span>
        {% elif st == 'pending' %}
          <span class="badge bg-secondary-lt text-uppercase"><i class="fas fa-clock me-1"></i>{{ st }}</span>
        {% elif st == 'cancelled' %}
          <span class="badge bg-muted-lt text-uppercase"><i class="fas fa-ban me-1"></i>{{ st }}</span>
        {% else %}
          <span class="badge bg-secondary text-uppercase">{{ task.status }}</span>
        {% endif %}
      </div>
      <div class="col-sm-6 col-lg-4">
        <div class="text-muted text-uppercase tiny">Type</div>
        {{ task.analysis_type }}
      </div>
      <div class="col-sm-6 col-lg-4">
        <div class="text-muted text-uppercase tiny">Priority</div>
        <span class="badge bg-info text-dark">{{ task.priority }}</span>
      </div>
      <div class="col-sm-6 col-lg-3">
        <div class="text-muted text-uppercase tiny">Model</div>
        {{ task.target_model }}
      </div>
      <div class="col-sm-6 col-lg-3">
        <div class="text-muted text-uppercase tiny">App #</div>
        {{ task.target_app_number }}
      </div>
      <div class="col-sm-6 col-lg-3">
        <div class="text-muted text-uppercase tiny">Progress</div>
        <div class="d-flex align-items-center gap-2">
          <div class="progress progress-xs flex-grow-1"
               data-progress="{{ task.progress_percentage or 0 }}"
               role="progressbar"
               aria-valuemin="0"
               aria-valuemax="100"
               aria-valuenow="{{ '%.0f'|format(task.progress_percentage or 0) }}"
               aria-label="{{ 'Task progress: %.0f%%'|format(task.progress_percentage or 0) }}">
            <div class="progress-bar"></div>
          </div>
          <span>{{ '%.0f'|format(task.progress_percentage or 0) }}%</span>
        </div>
      </div>
      <div class="col-sm-6 col-lg-3">
        <div class="text-muted text-uppercase tiny">Issues Found</div>
        {{ task.issues_found or 0 }}
      </div>
      <div class="col-sm-6 col-lg-3">
        <div class="text-muted text-uppercase tiny">Created</div>
        {{ task.created_at if task.created_at }}
      </div>
      <div class="col-sm-6 col-lg-3">
        <div class="text-muted text-uppercase tiny">Started</div>
        {{ task.started_at if task.started_at else '-' }}
      </div>
      <div class="col-sm-6 col-lg-3">
        <div class="text-muted text-uppercase tiny">Completed</div>
        {{ task.completed_at if task.completed_at else '-' }}
      </div>
      <div class="col-sm-6 col-lg-3">
        <div class="text-muted text-uppercase tiny">Elapsed (s)</div>
        {{ '%.1f'|format(task.elapsed_seconds) if task.elapsed_seconds is defined else '-' }}
      </div>
      {% if task.error_message %}
      <div class="col-12">
        <div class="alert alert-danger py-2 px-3 mb-0"><strong>Error:</strong> {{ task.error_message }}</div>
      </div>
      {% endif %}
    </div>
  </div>
</div>
