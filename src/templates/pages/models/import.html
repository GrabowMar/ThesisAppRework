{# Import Models migrated fully to pages/models #}
{% extends 'layouts/base.html' %}
{% set page_title = 'Import Models' %}
{% set page_icon = 'fas fa-upload' %}
{% set page_subtitle = 'Upload JSON export or OpenRouter payload to add/update models' %}
{% set actions = [ {'label':'Back to Models','href':'/models','icon':'arrow-left','class':'btn-outline-secondary'} ] %}
{% block content %}

<div class="card">
  <div class="card-header">
    <h3 class="card-title">Import File</h3>
  </div>
  <div class="card-body">
    <div class="mb-3">
      <label class="form-label">JSON File</label>
      <input type="file" id="models-file" class="form-control" accept="application/json" />
      <small class="form-hint">Upload a JSON export or OpenRouter payload to add/update models.</small>
    </div>
    <div class="d-flex gap-2">
      <button class="btn btn-primary" onclick="importModels()"><i class="fas fa-upload me-1"></i>Import</button>
      <a href="/models" class="btn btn-outline-secondary">Cancel</a>
    </div>
    <div class="mt-3" id="import-result"></div>
  </div>
</div>
{% endblock %}
{% block scripts %}
{{ super() }}
<script>
async function importModels(){const input=document.getElementById('models-file');const out=document.getElementById('import-result');out.innerHTML='';if(!input.files||!input.files[0]){out.innerHTML='<div class="alert alert-warning">Choose a JSON file.</div>';return;}try{const text=await input.files[0].text();const json=JSON.parse(text);const res=await fetch('/api/models/import',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(json)});const data=await res.json();if(!res.ok||data.success===false){out.innerHTML=`<div class="alert alert-danger">Import failed: ${data.error||res.statusText}</div>`;}else{out.innerHTML=`<div class="alert alert-success">Imported. Created: ${data.created} Updated: ${data.updated}</div>`;}}catch(e){out.innerHTML=`<div class="alert alert-danger">Error: ${e}</div>`;}}
</script>
{% endblock %}
