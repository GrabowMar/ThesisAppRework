{# Model Overview Section - Compact Layout #}
<div class="row g-2">
  {# Combined Identity & Status #}
  <div class="col-lg-7">
    <div class="card card-sm h-100 shadow-sm">
      <div class="card-body py-2">
        <div class="row g-3">
          {# Identity Column #}
          <div class="col-md-6">
            <div class="d-flex align-items-center mb-2">
              <i class="fa-solid fa-id-badge text-primary me-2" aria-hidden="true"></i>
              <span class="text-muted small text-uppercase fw-bold">Identity</span>
            </div>
            <div class="row row-cols-2 g-2">
              <div class="col">
                <div class="text-muted small">Display Name</div>
                <div class="fw-medium text-truncate" title="{{ model.get('display_name') or model.get('model_name') or enriched_data.get('openrouter_name') or 'Unknown' }}">{{ model.get('display_name') or model.get('model_name') or enriched_data.get('openrouter_name') or 'Unknown' }}</div>
              </div>
              <div class="col">
                <div class="text-muted small">Provider</div>
                <span class="badge bg-primary-lt text-primary">{{ model.get('provider', 'Unknown') }}</span>
              </div>
              <div class="col">
                <div class="text-muted small">Database ID</div>
                <div class="fw-medium">#{{ model.get('id', 'N/A') }}</div>
              </div>
              <div class="col">
                <div class="text-muted small">Status</div>
                <span class="badge {{ 'bg-success-lt text-success' if model.get('installed') else 'bg-secondary-lt' }}">
                  {{ 'Active' if model.get('installed') else 'Available' }}
                </span>
              </div>
            </div>
          </div>
          {# Sync & Stats Column #}
          <div class="col-md-6">
            <div class="d-flex align-items-center mb-2">
              <i class="fa-solid fa-clock text-success me-2" aria-hidden="true"></i>
              <span class="text-muted small text-uppercase fw-bold">Sync & Stats</span>
            </div>
            <div class="row row-cols-2 g-2">
              <div class="col">
                <div class="text-muted small">Last Updated</div>
                <div class="fw-medium">{% if model.get('updated_at') %}{{ model.updated_at.strftime('%Y-%m-%d %H:%M') }}{% else %}—{% endif %}</div>
              </div>
              <div class="col">
                <div class="text-muted small">Linked Apps</div>
                <div class="fw-medium">{{ model.get('apps_count', 0) }}</div>
              </div>
              {% set created_ts = enriched_data.get('capabilities', {}).get('created') %}
              {% if created_ts %}
              <div class="col">
                <div class="text-muted small">Created (OpenRouter)</div>
                <div class="fw-medium">{{ created_ts | int | timestamp_to_date }}</div>
              </div>
              {% endif %}
              {% if enriched_data.get('openrouter_canonical_slug') %}
              <div class="col">
                <div class="text-muted small">Canonical Slug</div>
                <code class="small text-truncate d-block" title="{{ enriched_data.get('openrouter_canonical_slug') }}">{{ enriched_data.get('openrouter_canonical_slug') }}</code>
              </div>
              {% endif %}
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  {# Capacity Card - Compact #}
  <div class="col-lg-5">
    <div class="card card-sm h-100 shadow-sm">
      <div class="card-body py-2">
        <div class="d-flex align-items-center mb-2">
          <i class="fa-solid fa-database text-info me-2" aria-hidden="true"></i>
          <span class="text-muted small text-uppercase fw-bold">Capacity</span>
        </div>
        <div class="row g-2 text-center">
          <div class="col-6">
            <div class="h3 mb-0 text-primary">
              {% if enriched_data.get('openrouter_context_length') %}{{ "{:,}".format(enriched_data.get('openrouter_context_length') // 1000) }}K{% elif model.get('context_window') %}{{ "{:,}".format(model.get('context_window') // 1000) }}K{% else %}—{% endif %}
            </div>
            <div class="text-muted small">Context</div>
          </div>
          <div class="col-6">
            <div class="h3 mb-0 text-success">
              {% if enriched_data.get('top_provider_max_completion_tokens') %}{{ "{:,}".format(enriched_data.get('top_provider_max_completion_tokens') // 1000) }}K{% else %}—{% endif %}
            </div>
            <div class="text-muted small">Max Output</div>
          </div>
        </div>
        <div class="d-flex flex-wrap gap-1 mt-2 justify-content-center">
          {% if model.get('is_free') or enriched_data.get('openrouter_is_free') %}<span class="badge bg-success-lt"><i class="fa-solid fa-gift me-1"></i>Free</span>{% endif %}
          {% if enriched_data.get('top_provider_is_moderated') %}<span class="badge bg-info-lt"><i class="fa-solid fa-shield-alt me-1"></i>Moderated</span>{% endif %}
          {% if model.get('installed') %}<span class="badge bg-primary-lt"><i class="fa-solid fa-download me-1"></i>Installed</span>{% endif %}
        </div>
      </div>
    </div>
  </div>

  {# Performance Score & External Links #}
  {% set perf_score = enriched_data.get('performance_score') %}
  {% set hf_id = enriched_data.get('capabilities', {}).get('hugging_face_id') or enriched_data.get('hugging_face_id') %}
  {% if perf_score or hf_id %}
  <div class="col-12">
    <div class="card card-sm shadow-sm">
      <div class="card-body py-2">
        <div class="d-flex align-items-center flex-wrap gap-3">
          {% if perf_score %}
          <div class="d-flex align-items-center gap-2">
            <i class="fa-solid fa-chart-line {% if perf_score > 0.7 %}text-success{% elif perf_score > 0.4 %}text-warning{% else %}text-secondary{% endif %}" aria-hidden="true"></i>
            <span class="text-muted small">Performance Score:</span>
            <span class="badge {% if perf_score > 0.7 %}bg-success-lt text-success{% elif perf_score > 0.4 %}bg-warning-lt text-warning{% else %}bg-secondary-lt{% endif %}">
              {{ '%.2f'|format(perf_score) }}
            </span>
          </div>
          {% endif %}
          {% if hf_id %}
          <div class="d-flex align-items-center gap-2">
            <svg class="text-warning" style="width: 16px; height: 16px;" viewBox="0 0 95 88" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M47.2 0C21.1 0 0 21.2 0 47.3c0 26.2 21.1 47.3 47.2 47.3 26.1 0 47.2-21.2 47.2-47.3C94.4 21.2 73.3 0 47.2 0zm0 88.4C23.5 88.4 4.2 69.1 4.2 45.4S23.5 2.4 47.2 2.4s43 19.3 43 43-19.3 43-43 43zm24.2-43.1c0-1.8-1.1-3.3-2.7-3.9.6-.9 1-2 1-3.1 0-3.1-2.5-5.6-5.6-5.6-2.2 0-4.1 1.3-5 3.2-.8-1.9-2.7-3.2-5-3.2-3.1 0-5.6 2.5-5.6 5.6 0 1.1.3 2.2 1 3.1-1.6.6-2.7 2.1-2.7 3.9 0 2.3 1.8 4.1 4.1 4.1h16.4c2.3 0 4.1-1.8 4.1-4.1zM33.1 32.7c-3.1 0-5.6 2.5-5.6 5.6 0 1.1.3 2.2 1 3.1-1.6.6-2.7 2.1-2.7 3.9 0 2.3 1.8 4.1 4.1 4.1h16.4c2.3 0 4.1-1.8 4.1-4.1 0-1.8-1.1-3.3-2.7-3.9.6-.9 1-2 1-3.1 0-3.1-2.5-5.6-5.6-5.6-2.2 0-4.1 1.3-5 3.2-.8-1.9-2.7-3.2-5-3.2zM47.2 52.3c-8.2 0-14.9 6.7-14.9 14.9h4.2c0-5.9 4.8-10.7 10.7-10.7 5.9 0 10.7 4.8 10.7 10.7h4.2c0-8.2-6.7-14.9-14.9-14.9z"/></svg>
            <span class="text-muted small">Hugging Face:</span>
            <a href="https://huggingface.co/{{ hf_id }}" target="_blank" rel="noopener noreferrer" class="small text-decoration-none">
              <code>{{ hf_id }}</code>
              <i class="fa-solid fa-external-link-alt ms-1 small"></i>
            </a>
          </div>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
  {% endif %}

  {# Description - Only if exists, inline #}
  {% if enriched_data.get('openrouter_description') %}
  <div class="col-12">
    <div class="card card-sm shadow-sm">
      <div class="card-body py-2">
        <div class="d-flex align-items-start">
          <i class="fa-solid fa-file-alt text-warning me-2 mt-1" aria-hidden="true"></i>
          <p class="mb-0 small">{{ enriched_data.get('openrouter_description') }}</p>
        </div>
      </div>
    </div>
  </div>
  {% endif %}

  {# Model Variants - Inline if exists #}
  {% set variants = enriched_data.get('openrouter_variants') %}
  {% if variants %}
  <div class="col-12">
    <div class="card card-sm shadow-sm">
      <div class="card-body py-2">
        <div class="d-flex align-items-center flex-wrap gap-2">
          <span class="text-muted small"><i class="fa-solid fa-layer-group text-purple me-1"></i>Variants:</span>
          {% if variants is iterable and variants is not string %}
            {% for variant in variants %}<span class="badge bg-purple-lt">{{ variant }}</span>{% endfor %}
          {% else %}
            <span class="badge bg-purple-lt">{{ variants }}</span>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
  {% endif %}
</div>