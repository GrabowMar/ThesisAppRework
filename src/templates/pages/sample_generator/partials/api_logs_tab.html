{# API Logs Tab - View OpenRouter API Requests & Responses #}
<div class="alert alert-info mb-4">
  <div class="d-flex">
    <div>
      <svg xmlns="http://www.w3.org/2000/svg" class="icon alert-icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0" /><path d="M12 9h.01" /><path d="M11 12h1v4h1" /></svg>
    </div>
    <div>
      <h4 class="alert-title">API Logs & Debugging</h4>
      <div class="text-secondary">View OpenRouter API requests, responses, and improve generation quality</div>
    </div>
  </div>
</div>

<div class="row g-4 mb-4">
  <!-- Request/Response Viewer -->
  <div class="col-12">
    <div class="card">
      <div class="card-header">
        <h3 class="card-title">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon me-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 7h-3a2 2 0 0 0 -2 2v9a2 2 0 0 0 2 2h9a2 2 0 0 0 2 -2v-3" /><path d="M9 15h3l8.5 -8.5a1.5 1.5 0 0 0 -3 -3l-8.5 8.5v3" /><path d="M16 5l3 3" /></svg>
          Recent API Calls
        </h3>
        <div class="card-actions">
          <button class="btn btn-sm btn-ghost-secondary" id="refresh-api-logs-btn" type="button" title="Refresh">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M20 11a8.1 8.1 0 0 0 -15.5 -2m-.5 -4v4h4" /><path d="M4 13a8.1 8.1 0 0 0 15.5 2m.5 4v-4h-4" /></svg>
          </button>
        </div>
      </div>
      <div class="card-body border-bottom">
        <div class="row g-3">
          <div class="col-md-4">
            <label for="api-logs-model-filter" class="form-label">Model</label>
            <select id="api-logs-model-filter" class="form-select">
              <option value="">All models</option>
            </select>
          </div>
          <div class="col-md-3">
            <label for="api-logs-status-filter" class="form-label">Status</label>
            <select id="api-logs-status-filter" class="form-select">
              <option value="">All</option>
              <option value="success">Success (200)</option>
              <option value="error">Error (4xx/5xx)</option>
            </select>
          </div>
          <div class="col-md-2">
            <label for="api-logs-limit" class="form-label">Limit</label>
            <select id="api-logs-limit" class="form-select">
              <option value="10">10</option>
              <option value="25" selected>25</option>
              <option value="50">50</option>
            </select>
          </div>
          <div class="col-md-3 d-flex align-items-end">
            <button id="apply-api-logs-filters-btn" class="btn btn-primary w-100" type="button">
              Apply Filters
            </button>
          </div>
        </div>
      </div>
      <div class="list-group list-group-flush" id="api-logs-list">
        <div class="list-group-item text-center text-muted py-4">
          <p class="mb-0">No API logs found. Start a generation to see requests.</p>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- API Call Detail Modal -->
<div class="modal modal-blur fade" id="api-detail-modal" tabindex="-1" role="dialog">
  <div class="modal-dialog modal-xl modal-dialog-centered modal-dialog-scrollable" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">API Call Details</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="row g-3">
          <!-- Request Column -->
          <div class="col-lg-6">
            <div class="card">
              <div class="card-header">
                <h4 class="card-title">
                  <svg xmlns="http://www.w3.org/2000/svg" class="icon me-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 6l6 6l-6 6" /></svg>
                  Request
                </h4>
                <div class="card-actions">
                  <button class="btn btn-sm btn-ghost-secondary" id="copy-request-detail-btn" type="button" title="Copy">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M8 8m0 2a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2z" /><path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2" /></svg>
                  </button>
                </div>
              </div>
              <div class="card-body">
                <!-- Request Metadata -->
                <div class="mb-3">
                  <div class="row g-2 small">
                    <div class="col-6">
                      <div class="text-muted">Model</div>
                      <div class="fw-bold" id="detail-request-model">—</div>
                    </div>
                    <div class="col-6">
                      <div class="text-muted">Temperature</div>
                      <div class="fw-bold" id="detail-request-temperature">—</div>
                    </div>
                    <div class="col-6">
                      <div class="text-muted">Max Tokens</div>
                      <div class="fw-bold" id="detail-request-max-tokens">—</div>
                    </div>
                    <div class="col-6">
                      <div class="text-muted">Top P</div>
                      <div class="fw-bold" id="detail-request-top-p">—</div>
                    </div>
                  </div>
                </div>

                <!-- Request Tabs -->
                <ul class="nav nav-tabs mb-3" role="tablist">
                  <li class="nav-item">
                    <a class="nav-link active" data-bs-toggle="tab" href="#req-system" role="tab">System</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" data-bs-toggle="tab" href="#req-user" role="tab">User Prompt</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" data-bs-toggle="tab" href="#req-full" role="tab">Full JSON</a>
                  </li>
                </ul>

                <div class="tab-content">
                  <div class="tab-pane fade show active" id="req-system" role="tabpanel">
                    <pre class="bg-secondary-lt p-3 rounded" style="max-height: 400px; overflow-y: auto;"><code id="detail-request-system">—</code></pre>
                  </div>
                  <div class="tab-pane fade" id="req-user" role="tabpanel">
                    <pre class="bg-secondary-lt p-3 rounded" style="max-height: 400px; overflow-y: auto;"><code id="detail-request-user">—</code></pre>
                  </div>
                  <div class="tab-pane fade" id="req-full" role="tabpanel">
                    <pre class="bg-secondary-lt p-3 rounded" style="max-height: 400px; overflow-y: auto;"><code id="detail-request-full">—</code></pre>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Response Column -->
          <div class="col-lg-6">
            <div class="card">
              <div class="card-header">
                <h4 class="card-title">
                  <svg xmlns="http://www.w3.org/2000/svg" class="icon me-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M15 6l-6 6l6 6" /></svg>
                  Response
                </h4>
                <div class="card-actions">
                  <button class="btn btn-sm btn-ghost-secondary" id="copy-response-detail-btn" type="button" title="Copy">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M8 8m0 2a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2z" /><path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2" /></svg>
                  </button>
                </div>
              </div>
              <div class="card-body">
                <!-- Response Metadata -->
                <div class="mb-3">
                  <div class="row g-2 small">
                    <div class="col-6">
                      <div class="text-muted">Status</div>
                      <div class="fw-bold" id="detail-response-status">—</div>
                    </div>
                    <div class="col-6">
                      <div class="text-muted">Duration</div>
                      <div class="fw-bold" id="detail-response-duration">—</div>
                    </div>
                    <div class="col-6">
                      <div class="text-muted">Tokens</div>
                      <div class="fw-bold" id="detail-response-tokens">—</div>
                    </div>
                    <div class="col-6">
                      <div class="text-muted">Cost</div>
                      <div class="fw-bold" id="detail-response-cost">—</div>
                    </div>
                  </div>
                </div>

                <!-- Response Tabs -->
                <ul class="nav nav-tabs mb-3" role="tablist">
                  <li class="nav-item">
                    <a class="nav-link active" data-bs-toggle="tab" href="#resp-content" role="tab">Content</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" data-bs-toggle="tab" href="#resp-full" role="tab">Full JSON</a>
                  </li>
                </ul>

                <div class="tab-content">
                  <div class="tab-pane fade show active" id="resp-content" role="tabpanel">
                    <pre class="bg-secondary-lt p-3 rounded" style="max-height: 400px; overflow-y: auto;"><code id="detail-response-content">—</code></pre>
                  </div>
                  <div class="tab-pane fade" id="resp-full" role="tabpanel">
                    <pre class="bg-secondary-lt p-3 rounded" style="max-height: 400px; overflow-y: auto;"><code id="detail-response-full">—</code></pre>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<!-- Generation Quality Tips -->
<div class="card">
  <div class="card-header">
    <h3 class="card-title">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon me-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 9v4" /><path d="M10.363 3.591l-8.106 13.534a1.914 1.914 0 0 0 1.636 2.871h16.214a1.914 1.914 0 0 0 1.636 -2.87l-8.106 -13.536a1.914 1.914 0 0 0 -3.274 0z" /><path d="M12 16h.01" /></svg>
      Improving Generation Quality
    </h3>
  </div>
  <div class="card-body">
    <div class="row g-3">
      <div class="col-md-6">
        <h4 class="text-primary">Best Practices</h4>
        <ul class="list-unstyled">
          <li class="mb-2">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon text-success me-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 12l5 5l10 -10" /></svg>
            <strong>Use specific prompts</strong> - More detail = better results
          </li>
          <li class="mb-2">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon text-success me-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 12l5 5l10 -10" /></svg>
            <strong>Set temperature</strong> - Lower (0.3-0.5) for consistent code
          </li>
          <li class="mb-2">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon text-success me-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 12l5 5l10 -10" /></svg>
            <strong>Increase max_tokens</strong> - Give models room for complete code
          </li>
          <li class="mb-2">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon text-success me-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 12l5 5l10 -10" /></svg>
            <strong>Try different models</strong> - Some excel at specific tasks
          </li>
        </ul>
      </div>
      <div class="col-md-6">
        <h4 class="text-danger">Common Issues</h4>
        <ul class="list-unstyled">
          <li class="mb-2">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon text-danger me-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0" /><path d="M10 10l4 4m0 -4l-4 4" /></svg>
            <strong>Vague prompts</strong> - Models guess what you want
          </li>
          <li class="mb-2">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon text-danger me-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0" /><path d="M10 10l4 4m0 -4l-4 4" /></svg>
            <strong>Max tokens too low</strong> - Code gets cut off mid-function
          </li>
          <li class="mb-2">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon text-danger me-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0" /><path d="M10 10l4 4m0 -4l-4 4" /></svg>
            <strong>High temperature</strong> - Unpredictable, creative (bad for code)
          </li>
          <li class="mb-2">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon text-danger me-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0" /><path d="M10 10l4 4m0 -4l-4 4" /></svg>
            <strong>Wrong model for task</strong> - Not all models code equally well
          </li>
        </ul>
      </div>
    </div>
  </div>
</div>
