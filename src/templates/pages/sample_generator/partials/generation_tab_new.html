{# Generation Tab - Unified Individual & Batch Generation Interface #}
<div class="alert alert-azure mb-4">
  <div class="d-flex">
    <div>
      <svg xmlns="http://www.w3.org/2000/svg" class="icon alert-icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0" /><path d="M12 8l0 4" /><path d="M12 16l.01 0" /></svg>
    </div>
    <div>
      <h4 class="alert-title">AI Code Generation</h4>
      <div class="text-secondary">Generate application code using AI models from scaffolded projects</div>
    </div>
  </div>
</div>

<div class="row g-4">
  <!-- Left: Selection & Configuration -->
  <div class="col-xl-6">
    <!-- Template Selection -->
    <div class="card mb-3">
      <div class="card-header">
        <h3 class="card-title">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon me-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 8l-4 4l4 4" /><path d="M17 8l4 4l-4 4" /><path d="M14 4l-4 16" /></svg>
          Application Templates
        </h3>
        <div class="card-actions">
          <button id="gen-reload-templates-btn" class="btn btn-sm btn-ghost-secondary" type="button" title="Reload templates">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M20 11a8.1 8.1 0 0 0 -15.5 -2m-.5 -4v4h4" /><path d="M4 13a8.1 8.1 0 0 0 15.5 2m.5 4v-4h-4" /></svg>
          </button>
        </div>
      </div>
      <div class="card-body">
        <!-- Selection Mode -->
        <div class="mb-3">
          <label class="form-label fw-semibold">Selection mode</label>
          <div class="btn-group w-100" role="group">
            <input type="radio" class="btn-check" name="gen-template-mode" id="gen-template-single" value="single" checked>
            <label class="btn btn-outline-primary" for="gen-template-single">
              <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-inline me-1" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M14 3v4a1 1 0 0 0 1 1h4" /><path d="M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z" /></svg>
              Single
            </label>
            <input type="radio" class="btn-check" name="gen-template-mode" id="gen-template-multiple" value="multiple">
            <label class="btn btn-outline-primary" for="gen-template-multiple">
              <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-inline me-1" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v10a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" /><path d="M17 17v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2v-10a2 2 0 0 1 2 -2h2" /></svg>
              Multiple
            </label>
            <input type="radio" class="btn-check" name="gen-template-mode" id="gen-template-all" value="all">
            <label class="btn btn-outline-primary" for="gen-template-all">
              <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-inline me-1" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 3c7.2 0 9 1.8 9 9s-1.8 9 -9 9s-9 -1.8 -9 -9s1.8 -9 9 -9z" /><path d="M8 12l2 2l4 -4" /></svg>
              All
            </label>
          </div>
        </div>

        <!-- Single Template Selector -->
        <div id="gen-single-template-selector" class="mb-3">
          <label for="gen-template-select" class="form-label">Choose template</label>
          <select id="gen-template-select" class="form-select">
            <option value="">Loading templates...</option>
          </select>
        </div>

        <!-- Multiple Template Selector -->
        <div id="gen-multiple-template-selector" class="mb-3 d-none">
          <div class="d-flex justify-content-between align-items-center mb-2">
            <label class="form-label mb-0">Select templates</label>
            <button class="btn btn-sm btn-ghost-secondary" id="gen-toggle-all-templates" type="button">
              <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-inline me-1" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 11l3 3l8 -8" /><path d="M20 12v6a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h9" /></svg>
              Toggle All
            </button>
          </div>
          <div class="card card-sm bg-secondary-lt" style="max-height: 250px; overflow-y: auto;">
            <div class="list-group list-group-flush" id="gen-template-checkbox-list">
              <div class="list-group-item text-center text-muted">
                <div class="spinner-border spinner-border-sm me-2" role="status"></div>
                Loading templates...
              </div>
            </div>
          </div>
          <div class="form-hint mt-2">
            <span id="gen-templates-selected-count">0</span> template(s) selected
          </div>
        </div>

        <!-- Template Preview -->
        <div class="card card-sm bg-secondary-lt">
          <div class="card-header">
            <div class="card-title">Template Preview</div>
          </div>
          <div class="card-body p-2" style="max-height: 200px; overflow-y: auto;">
            <div id="gen-template-preview" class="small text-secondary">
              <div class="empty">
                <p class="empty-title">No template selected</p>
                <p class="empty-subtitle">Select a template to preview its content</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Model Selection -->
    <div class="card">
      <div class="card-header">
        <h3 class="card-title">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon me-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M8 9h8" /><path d="M8 13h6" /><path d="M18 4a3 3 0 0 1 3 3v8a3 3 0 0 1 -3 3h-5l-5 3v-3h-2a3 3 0 0 1 -3 -3v-8a3 3 0 0 1 3 -3h12z" /></svg>
          AI Models
        </h3>
        <div class="card-actions">
          <button class="btn btn-sm btn-ghost-secondary" id="gen-refresh-models-btn" type="button" title="Refresh models">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0" /><path d="M12 12l0 -3" /><path d="M12 12l2 2" /></svg>
          </button>
        </div>
      </div>
      <div class="card-body">
        <!-- Selection Mode -->
        <div class="mb-3">
          <label class="form-label fw-semibold">Selection mode</label>
          <div class="btn-group w-100" role="group">
            <input type="radio" class="btn-check" name="gen-model-mode" id="gen-model-single" value="single" checked>
            <label class="btn btn-outline-primary" for="gen-model-single">
              <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-inline me-1" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 3c7.2 0 9 1.8 9 9s-1.8 9 -9 9s-9 -1.8 -9 -9s1.8 -9 9 -9z" /></svg>
              Single
            </label>
            <input type="radio" class="btn-check" name="gen-model-mode" id="gen-model-multiple" value="multiple">
            <label class="btn btn-outline-primary" for="gen-model-multiple">
              <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-inline me-1" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v10a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" /><path d="M17 17v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2v-10a2 2 0 0 1 2 -2h2" /></svg>
              Multiple
            </label>
            <input type="radio" class="btn-check" name="gen-model-mode" id="gen-model-all" value="all">
            <label class="btn btn-outline-primary" for="gen-model-all">
              <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-inline me-1" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 3c7.2 0 9 1.8 9 9s-1.8 9 -9 9s-9 -1.8 -9 -9s1.8 -9 9 -9z" /><path d="M8 12l2 2l4 -4" /></svg>
              All
            </label>
          </div>
          <div class="form-hint">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-inline me-1" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0" /><path d="M12 8l0 4" /><path d="M12 16l.01 0" /></svg>
            Only models with scaffolded projects are shown
          </div>
        </div>

        <!-- Single Model Selector -->
        <div id="gen-single-model-selector" class="mb-3">
          <label for="gen-model-select" class="form-label">Choose model</label>
          <select id="gen-model-select" class="form-select">
            <option value="">Loading scaffolded models...</option>
          </select>
        </div>

        <!-- Multiple Model Selector -->
        <div id="gen-multiple-model-selector" class="mb-3 d-none">
          <div class="d-flex justify-content-between align-items-center mb-2">
            <label class="form-label mb-0">Select models</label>
            <button class="btn btn-sm btn-ghost-secondary" id="gen-toggle-all-models" type="button">
              <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-inline me-1" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 11l3 3l8 -8" /><path d="M20 12v6a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h9" /></svg>
              Toggle All
            </button>
          </div>
          <div class="card card-sm bg-secondary-lt" style="max-height: 250px; overflow-y: auto;">
            <div class="list-group list-group-flush" id="gen-model-checkbox-list">
              <div class="list-group-item text-center text-muted">
                <div class="spinner-border spinner-border-sm me-2" role="status"></div>
                Loading scaffolded models...
              </div>
            </div>
          </div>
          <div class="form-hint mt-2">
            <span id="gen-models-selected-count">0</span> model(s) selected
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Right: Options & Actions -->
  <div class="col-xl-6">
    <!-- Generation Options -->
    <div class="card mb-3">
      <div class="card-header">
        <h3 class="card-title">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon me-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M10.325 4.317c.426 -1.756 2.924 -1.756 3.35 0a1.724 1.724 0 0 0 2.573 1.066c1.543 -.94 3.31 .826 2.37 2.37a1.724 1.724 0 0 0 1.065 2.572c1.756 .426 1.756 2.924 0 3.35a1.724 1.724 0 0 0 -1.066 2.573c.94 1.543 -.826 3.31 -2.37 2.37a1.724 1.724 0 0 0 -2.572 1.065c-.426 1.756 -2.924 1.756 -3.35 0a1.724 1.724 0 0 0 -2.573 -1.066c-1.543 .94 -3.31 -.826 -2.37 -2.37a1.724 1.724 0 0 0 -1.065 -2.572c-1.756 -.426 -1.756 -2.924 0 -3.35a1.724 1.724 0 0 0 1.066 -2.573c-.94 -1.543 .826 -3.31 2.37 -2.37c1 .608 2.296 .07 2.572 -1.065z" /><path d="M9 12a3 3 0 1 0 6 0a3 3 0 0 0 -6 0" /></svg>
          Generation Options
        </h3>
      </div>
      <div class="card-body">
        <!-- Scope -->
        <div class="mb-3">
          <label class="form-label fw-semibold">Generation scope</label>
          <div class="row g-2">
            <div class="col-sm-4">
              <label class="form-check form-switch">
                <input class="form-check-input" type="checkbox" id="gen-scope-frontend" checked>
                <span class="form-check-label">
                  <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-inline me-1" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 4m0 2a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2z" /><path d="M8 11l0 5" /><path d="M8 8l0 .01" /><path d="M12 8l0 8" /><path d="M16 8l0 8" /></svg>
                  Frontend
                </span>
              </label>
            </div>
            <div class="col-sm-4">
              <label class="form-check form-switch">
                <input class="form-check-input" type="checkbox" id="gen-scope-backend" checked>
                <span class="form-check-label">
                  <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-inline me-1" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 12h1m8 -9v1m8 8h1m-15.4 -6.4l.7 .7m12.1 -.7l-.7 .7" /><path d="M9 16a5 5 0 1 1 6 0a3.5 3.5 0 0 0 -1 3a2 2 0 0 1 -4 0a3.5 3.5 0 0 0 -1 -3" /><path d="M9.7 17l4.6 0" /></svg>
                  Backend
                </span>
              </label>
            </div>
            <div class="col-sm-4">
              <label class="form-check form-switch">
                <input class="form-check-input" type="checkbox" id="gen-scope-tests">
                <span class="form-check-label">
                  <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-inline me-1" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 12l2 2l4 -4" /><path d="M12 3a12 12 0 0 0 8.5 3a12 12 0 0 1 -8.5 15a12 12 0 0 1 -8.5 -15a12 12 0 0 0 8.5 -3" /></svg>
                  Tests
                </span>
              </label>
            </div>
          </div>
        </div>

        <!-- Advanced Settings -->
        <div class="card card-sm bg-azure-lt mb-3">
          <div class="card-body">
            <div class="row g-3">
              <div class="col-sm-6">
                <label class="form-label small">Concurrent Workers</label>
                <input type="number" class="form-control form-control-sm" id="gen-workers" min="1" max="10" value="3">
                <div class="form-hint">Parallel API requests (1-10)</div>
              </div>
              <div class="col-sm-6">
                <label class="form-label small">Timeout (seconds)</label>
                <input type="number" class="form-control form-control-sm" id="gen-timeout" min="60" max="900" value="300">
                <div class="form-hint">Per-request timeout</div>
              </div>
            </div>
            <div class="mt-3">
              <label class="form-check form-switch">
                <input class="form-check-input" type="checkbox" id="gen-create-backup" checked>
                <span class="form-check-label small">
                  <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-inline me-1" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 3a12 12 0 0 0 8.5 3a12 12 0 0 1 -8.5 15a12 12 0 0 1 -8.5 -15a12 12 0 0 0 8.5 -3" /></svg>
                  Create backups before overwriting
                </span>
              </label>
            </div>
          </div>
        </div>

        <!-- Generation Summary -->
        <div class="card card-sm bg-secondary-lt mb-3">
          <div class="card-body">
            <div class="mb-2"><strong>Generation Summary</strong></div>
            <div class="row g-2 text-secondary small">
              <div class="col-6">Templates: <strong id="gen-summary-templates">—</strong></div>
              <div class="col-6">Models: <strong id="gen-summary-models">—</strong></div>
              <div class="col-6">Total Jobs: <strong id="gen-summary-jobs">—</strong></div>
              <div class="col-6">Est. Time: <strong id="gen-summary-time">—</strong></div>
            </div>
          </div>
        </div>

        <!-- Action Buttons -->
        <div class="d-grid gap-2">
          <button id="gen-preview-btn" class="btn btn-outline-primary btn-lg" type="button" disabled>
            <svg xmlns="http://www.w3.org/2000/svg" class="icon me-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" /><path d="M21 12c-2.4 4 -5.4 6 -9 6c-3.6 0 -6.6 -2 -9 -6c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6" /></svg>
            Preview Generation Plan
          </button>
          <button id="gen-start-btn" class="btn btn-primary btn-lg" type="button" disabled>
            <svg xmlns="http://www.w3.org/2000/svg" class="icon me-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 4v16l13 -8z" /></svg>
            Start Generation
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
