{# HTMX fragment: recent generation results table body rows #}
{% if recent and recent|length %}
  {% for r in recent %}
    {% set ts = r.timestamp %}
    {% if ts is string %}
      {% set timestamp = ts %}
    {% elif ts and ts.strftime is defined %}
      {% set timestamp = ts.strftime('%Y-%m-%d %H:%M:%S') %}
    {% else %}
      {% set timestamp = '-' %}
    {% endif %}
    <tr>
      <td>{{ timestamp }}</td>
      <td>{{ r.app_name or ('App #' ~ (r.app_num or '?')) }}</td>
      <td>{{ r.model or '—' }}</td>
      <td>
        {% if r.status == 'completed' %}
          <span class="badge bg-success">Success</span>
        {% elif r.status == 'failed' %}
          <span class="badge bg-danger">Failed</span>
        {% elif r.status == 'running' %}
          <span class="badge bg-info">Running</span>
        {% else %}
          <span class="badge bg-warning">Pending</span>
        {% endif %}
      </td>
      <td class="text-muted small" style="max-width: 200px;">
        {% if r.error_message %}
          <span class="text-truncate d-inline-block" style="max-width: 190px;" title="{{ r.error_message }}">
            {{ r.error_message }}
          </span>
        {% else %}
          —
        {% endif %}
      </td>
      <td>{{ '%.1fs'|format(r.duration) if r.duration else '-' }}</td>
      <td class="text-end">
        <button type="button" class="btn btn-sm btn-ghost-primary"
                onclick="window.sampleGeneratorAppInstance?.viewResult('{{ r.result_id }}')">
          View
        </button>
      </td>
    </tr>
  {% endfor %}
{% else %}
  <tr><td colspan="7" class="text-center text-muted py-4">No recent generations</td></tr>
{% endif %}
