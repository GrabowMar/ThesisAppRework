# ThesisAppRework

A Flask-based platform for analyzing AI-generated applications. Evaluates code quality, security vulnerabilities, performance, and requirements compliance across multiple AI models.

## Features

- **Multi-Model Analysis** — Compare applications generated by OpenAI, Anthropic, and other AI providers
- **Comprehensive Testing** — Static analysis, security scanning, performance testing, and AI-powered code review
- **Docker-First Architecture** — Complete stack runs in containers with Celery for distributed task processing
- **Containerized Analyzers** — Isolated services for consistent, reproducible results
- **Real-time Progress** — WebSocket-based updates during analysis
- **SARIF Compliance** — Industry-standard security findings format
- **REST API** — Automation-friendly endpoints with Bearer token auth

## Architecture

```
┌─────────────────────────────────────────────────────────────┐
│                 Docker Compose Stack                        │
├─────────────────────────────────────────────────────────────┤
│  Flask Web (:5000) • Redis • Celery Worker                 │
│         Routes • Services • Task Queue • DB                 │
└─────────────────────────┬───────────────────────────────────┘
                          │ WebSocket
    ┌─────────────────────┼─────────────────────┐
    ▼                     ▼                     ▼             ▼
┌────────┐          ┌────────┐           ┌────────┐     ┌────────┐
│ Static │          │Dynamic │           │  Perf  │     │   AI   │
│ :2001  │          │ :2002  │           │ :2003  │     │ :2004  │
└────────┘          └────────┘           └────────┘     └────────┘
  Bandit              ZAP                  Locust         GPT-4
  Semgrep             nmap                 aiohttp        Claude
  ESLint              curl                 ab             LLM
```

## Quick Start

### Prerequisites

- **Docker Desktop** (Required)
- **Git**
- Python 3.10+ (Optional - for local development only)

### Setup with Docker Compose (Recommended)

```bash
# Clone repository
git clone https://github.com/GrabowMar/ThesisAppRework.git
cd ThesisAppRework

# Configure environment
cp .env.example .env
# Edit .env with your OPENROUTER_API_KEY

# Start complete stack
docker compose up -d
```

**Services started:**
- Flask web application (port 5000)
- Redis (Celery task queue)
- Celery worker (background processing)
- All analyzer services (static, dynamic, performance, AI)
- WebSocket gateway

Access at **http://localhost:5000**

### Management Commands

```bash
# View logs
docker compose logs -f web
docker compose logs -f celery-worker

# Check status
docker compose ps

# Restart services
docker compose restart

# Stop everything
docker compose down
```

### Local Development (Alternative)

For faster iteration without Docker:

```bash
# Setup Python environment
python -m venv .venv
.venv\Scripts\Activate.ps1   # Windows
source .venv/bin/activate    # Linux/Mac

# Install dependencies
pip install -r requirements.txt

# Initialize database
python src/init_db.py

# Run Flask locally
./start.ps1 -Mode Dev
# Or: python src/main.py
```

**Note:** Analyzers still require Docker containers.

## Project Structure

```
ThesisAppRework/
├── src/                    # Flask application
│   ├── main.py            # Entry point
│   ├── app/               # Application package
│   │   ├── factory.py     # App factory
│   │   ├── models/        # Database models
│   │   ├── services/      # Business logic
│   │   ├── routes/        # Web routes
│   │   └── api/           # REST API
│   └── templates/         # Jinja2 templates
├── analyzer/              # Analyzer microservices
│   ├── analyzer_manager.py
│   ├── docker-compose.yml
│   └── services/          # Container services
├── generated/apps/        # AI-generated applications
├── results/               # Analysis results
├── tests/                 # Test suite
└── docs/                  # Documentation
```

## Testing

```bash
# Fast unit tests (recommended)
pytest -m "not integration and not slow and not analyzer"

# Smoke tests
pytest tests/smoke/

# All tests
pytest
```

VS Code: Open **Testing** panel (Ctrl+Shift+T) for interactive test explorer.

## API

All endpoints require Bearer token authentication.

```bash
# Create analysis task
curl -X POST http://localhost:5000/api/analysis/run \
  -H "Authorization: Bearer <token>" \
  -H "Content-Type: application/json" \
  -d '{"model_slug": "openai_gpt-4", "app_number": 1, "analysis_type": "comprehensive"}'

# Check task status
curl http://localhost:5000/api/analysis/task/<task_id> \
  -H "Authorization: Bearer <token>"
```

Generate tokens via **User → API Access** in the web UI.

## Documentation

| Guide | Description |
|-------|-------------|
| [Docs Index](docs/README.md) | Entry point for all docs (including archive) |
| [Quick Start](docs/QUICKSTART.md) | Installation and first steps |
| [Architecture](docs/ARCHITECTURE.md) | System design, components, data flow |
| [API Reference](docs/api-reference.md) | REST endpoints, authentication |
| [Analyzer Guide](docs/ANALYZER_GUIDE.md) | Static, dynamic, and AI analyzers |
| [Models Reference](docs/MODELS_REFERENCE.md) | Supported AI models |
| [Development Guide](docs/development-guide.md) | Setup, testing, contributing |
| [Deployment Guide](docs/deployment-guide.md) | Production deployment |
| [Troubleshooting](docs/TROUBLESHOOTING.md) | Common issues and solutions |

## Environment Variables

| Variable | Description | Required |
|----------|-------------|----------|
| `OPENROUTER_API_KEY` | AI analyzer API key | Yes |
| `SECRET_KEY` | Flask secret key | Yes (prod) |
| `ANALYZER_ENABLED` | Enable analyzers | No (default: true) |
| `LOG_LEVEL` | Logging level | No (default: INFO) |

## Tech Stack

- **Backend**: Flask, SQLAlchemy, SocketIO
- **Database**: SQLite
- **Containers**: Docker, Docker Compose
- **Analysis**: Bandit, Semgrep, ESLint, OWASP ZAP, Locust
- **Testing**: pytest
- **AI**: OpenRouter API

## License

MIT

## Contributing

1. Fork the repository
2. Create a feature branch (`git checkout -b feature/amazing-feature`)
3. Commit changes (`git commit -m 'feat: add amazing feature'`)
4. Push to branch (`git push origin feature/amazing-feature`)
5. Open a Pull Request
